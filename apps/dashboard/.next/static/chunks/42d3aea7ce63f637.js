(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18545,(e,t,a)=>{t.exports=e.r(7284)},8643,e=>{"use strict";let t=null,a=()=>(t||(t=e.A(77861).then(e=>e.default)),t);e.s(["buttonRipple",0,e=>{let t=e.currentTarget,r=t.getBoundingClientRect(),s=e.clientX-r.left,i=e.clientY-r.top,n=document.createElement("span");n.style.cssText=`
    position: absolute;
    left: ${s}px;
    top: ${i}px;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.6);
    transform: translate(-50%, -50%);
    pointer-events: none;
  `,t.style.position="relative",t.style.overflow="hidden",t.appendChild(n),a()?.then(e=>{e({targets:n,width:2*Math.max(r.width,r.height),height:2*Math.max(r.width,r.height),opacity:[.6,0],duration:600,easing:"easeOutQuad",complete:()=>n.remove()})})},"cardHover",0,e=>{a()?.then(t=>{t({targets:e,scale:1.05,translateY:-8,duration:300,easing:"easeOutCubic"})})},"cardHoverEnd",0,e=>{a()?.then(t=>{t({targets:e,scale:1,translateY:0,duration:300,easing:"easeOutCubic"})})},"fadeIn",0,(e,t=0)=>{a()?.then(a=>{a({targets:e,opacity:[0,1],translateY:[20,0],duration:800,delay:t,easing:"easeOutCubic"})})},"scaleIn",0,(e,t=0)=>{a()?.then(a=>{a({targets:e,opacity:[0,1],scale:[.8,1],duration:600,delay:t,easing:"easeOutElastic(1, .6)"})})},"slideInBottom",0,(e,t=0)=>{a()?.then(a=>{a({targets:e,opacity:[0,1],translateY:[100,0],duration:1e3,delay:t,easing:"easeOutExpo"})})},"staggerFadeIn",0,e=>{a()?.then(t=>{t({targets:e,opacity:[0,1],translateY:[30,0],duration:800,delay:t.stagger(100),easing:"easeOutCubic"})})}])},65267,e=>{"use strict";e.i(4937);var t=e.i(78361),a=e.i(16015);let r={ORGANIZATIONS:"organizations",ORGANIZATION_MEMBERS:"organization_members",PROJECTS:"projects",ENVIRONMENTS:"environments",FEATURE_FLAGS:"feature_flags",FLAG_VALUES:"flag_values",API_KEYS:"api_keys",AUDIT_LOGS:"audit_logs",FLAG_ANALYTICS:"flag_analytics"};async function s(e){let s=await (0,t.addDoc)((0,t.collection)(a.db,r.ORGANIZATIONS),{...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});return await (0,t.setDoc)((0,t.doc)(a.db,r.ORGANIZATION_MEMBERS,`${e.createdBy}_${s.id}`),{organizationId:s.id,userId:e.createdBy,role:"owner",createdAt:(0,t.serverTimestamp)()}),s.id}async function i(e){let s=(0,t.query)((0,t.collection)(a.db,r.ORGANIZATION_MEMBERS),(0,t.where)("userId","==",e)),i=(await (0,t.getDocs)(s)).docs.map(e=>e.data().organizationId);if(0===i.length)return[];let n=(0,t.query)((0,t.collection)(a.db,r.ORGANIZATIONS),(0,t.where)("__name__","in",i));return(await (0,t.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}async function n(e){let s=await (0,t.addDoc)((0,t.collection)(a.db,r.PROJECTS),{...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});for(let e of[{name:"Development",key:"dev"},{name:"Staging",key:"staging"},{name:"Production",key:"prod"}])await (0,t.addDoc)((0,t.collection)(a.db,r.ENVIRONMENTS),{projectId:s.id,...e,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()});return s.id}async function l(e){let s=await (0,t.addDoc)((0,t.collection)(a.db,r.FEATURE_FLAGS),{...e,tags:e.tags||[],createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()}),i=(0,t.query)((0,t.collection)(a.db,r.ENVIRONMENTS),(0,t.where)("projectId","==",e.projectId));for(let n of(await (0,t.getDocs)(i)).docs)await (0,t.addDoc)((0,t.collection)(a.db,r.FLAG_VALUES),{flagId:s.id,environmentId:n.id,enabled:!1,value:e.defaultValue,updatedAt:(0,t.serverTimestamp)()});return s}async function d(s){let i=(await e.A(39007)).default,n=Array.from(crypto.getRandomValues(new Uint8Array(16))).map(e=>e.toString(16).padStart(2,"0")).join(""),l=`fsk_${s.keyType}_${n}`,d=await i.hash(l,10),c=l.substring(0,12);return await (0,t.addDoc)((0,t.collection)(a.db,r.API_KEYS),{environmentId:s.environmentId,name:s.name,keyPrefix:c,keyHash:d,keyType:s.keyType,revoked:!1,lastUsedAt:null,createdAt:(0,t.serverTimestamp)(),createdBy:s.createdBy}),l}async function c(e){let s=(0,t.doc)(a.db,r.API_KEYS,e);await (0,t.updateDoc)(s,{revoked:!0,updatedAt:(0,t.serverTimestamp)()})}async function o(e){let s=(0,t.query)((0,t.collection)(a.db,r.API_KEYS),(0,t.where)("environmentId","==",e),(0,t.where)("revoked","==",!1));return(await (0,t.getDocs)(s)).docs.map(e=>({id:e.id,...e.data()}))}async function u(s){let i=await (0,t.addDoc)((0,t.collection)(a.db,r.AUDIT_LOGS),{...s,timestamp:(0,t.serverTimestamp)(),createdAt:(0,t.serverTimestamp)()});if(s.projectId&&s.action){let{triggerWebhooks:t}=await e.A(49847),a={FLAG_CREATED:"flag.created",FLAG_UPDATED:"flag.updated",FLAG_DELETED:"flag.deleted",FLAG_TOGGLED:"flag.toggled",TARGETING_RULES_UPDATED:"targeting.updated"}[s.action];a&&t(s.projectId,a,{flagKey:s.metadata?.flagKey||s.resourceName,flagName:s.resourceName,action:s.action,actor:s.userEmail||"Unknown",changes:s.changes,before:s.changes?.before,after:s.changes?.after}).catch(e=>console.error("Webhook trigger error:",e))}return i}async function m(e,s=100){let i=(0,t.query)((0,t.collection)(a.db,r.AUDIT_LOGS),(0,t.where)("organizationId","==",e));return(await (0,t.getDocs)(i)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let a=e.timestamp?.toMillis()||e.createdAt?.toMillis()||0;return(t.timestamp?.toMillis()||t.createdAt?.toMillis()||0)-a}).slice(0,s)}async function p(e,s,i=7){let n=(0,t.query)((0,t.collection)(a.db,r.FLAG_ANALYTICS),(0,t.where)("projectId","==",e),(0,t.where)("environmentId","==",s)),l=(await (0,t.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()})),d=Date.now()-24*i*36e5;return l.filter(e=>(e.timestamp?.toMillis()||e.createdAt?.toMillis()||0)>=d)}async function g(e,t,a=7){let r=await p(e,t,a),s={};return r.forEach(e=>{let t=e.flagKey;s[t]||(s[t]={flagKey:t,flagId:e.flagId,evaluations:0,uniqueUsers:new Set,trueCount:0,falseCount:0,targetingAppliedCount:0}),s[t].evaluations++,e.userId&&s[t].uniqueUsers.add(e.userId),!0===e.result&&s[t].trueCount++,!1===e.result&&s[t].falseCount++,e.targetingApplied&&s[t].targetingAppliedCount++}),Object.values(s).map(e=>({...e,uniqueUsers:e.uniqueUsers.size}))}e.s(["COLLECTIONS",0,r,"createApiKey",()=>d,"createAuditLog",()=>u,"createFeatureFlag",()=>l,"createOrganization",()=>s,"createProject",()=>n,"getAggregatedAnalytics",()=>g,"getAuditLogs",()=>m,"getEnvironmentApiKeys",()=>o,"getUserOrganizations",()=>i,"revokeApiKey",()=>c])},22087,e=>{"use strict";var t=e.i(85434),a=e.i(78027);e.i(13893);var r=e.i(34708),s=e.i(16015),i=e.i(18545);e.i(4937);var n=e.i(78361),l=e.i(65267),d=e.i(8643);function c(){let e=(0,i.useParams)(),c=e.slug,o=e.projectKey,u=(0,i.useRouter)(),[m,p]=(0,a.useState)(null),[g,x]=(0,a.useState)(!0),[y,h]=(0,a.useState)(null),[f,b]=(0,a.useState)([]),[v,A]=(0,a.useState)(""),[N,w]=(0,a.useState)([]),[j,I]=(0,a.useState)(!1),[T,k]=(0,a.useState)({name:"",keyType:"server"}),[E,S]=(0,a.useState)(!1),[O,C]=(0,a.useState)(""),[_,D]=(0,a.useState)(!1),L=(0,a.useRef)(null),P=(0,a.useRef)(null);(0,a.useEffect)(()=>{document.title="API Keys | Flagship"},[]),(0,a.useEffect)(()=>{let e=(0,r.onAuthStateChanged)(s.auth,async e=>{e?(p(e),await R()):u.push("/login"),x(!1)});return()=>e()},[u,o]),(0,a.useEffect)(()=>{v&&G()},[v]);let R=async()=>{try{let e=(0,n.query)((0,n.collection)(s.db,l.COLLECTIONS.PROJECTS),(0,n.where)("key","==",o)),t=await (0,n.getDocs)(e);if(t.empty)u.push(`/dashboard/${c}`);else{let e={id:t.docs[0].id,...t.docs[0].data()};h(e),await K(e.id)}}catch(e){console.error("Error loading project:",e)}},K=async e=>{try{let t=(0,n.query)((0,n.collection)(s.db,l.COLLECTIONS.ENVIRONMENTS),(0,n.where)("projectId","==",e)),a=(await (0,n.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));b(a),a.length>0&&A(a[0].id)}catch(e){console.error("Error loading environments:",e)}},G=async()=>{try{let e=await (0,l.getEnvironmentApiKeys)(v);w(e)}catch(e){console.error("Error loading API keys:",e)}},M=async e=>{if(e.preventDefault(),m){S(!0);try{let e=await (0,l.createApiKey)({environmentId:v,name:T.name,keyType:T.keyType,createdBy:m.uid});C(e),k({name:"",keyType:"server"}),await G()}catch(e){console.error("Error creating API key:",e),alert("Hata: "+e.message)}finally{S(!1)}}};(0,a.useEffect)(()=>{L.current&&(0,d.fadeIn)(L.current,0),P.current&&(0,d.slideInBottom)(P.current,200)},[g]),(0,a.useEffect)(()=>{document.querySelectorAll(".api-key-card").length>0&&(0,d.staggerFadeIn)(".api-key-card")},[N]);let U=async e=>{if(confirm("Bu API key'i iptal etmek istediğinize emin misiniz?"))try{await (0,l.revokeApiKey)(e),await G()}catch(e){console.error("Error revoking key:",e)}};return g?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-600",children:"Yükleniyor..."})}):y?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("nav",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("button",{onClick:()=>u.push(`/dashboard/${c}/projects/${o}`),className:"text-gray-600 hover:text-gray-900",children:"← Geri"}),(0,t.jsxs)("h1",{className:"text-xl font-bold text-gray-900",children:[y.name," - API Keys"]})]}),(0,t.jsx)("div",{className:"flex items-center space-x-4",children:(0,t.jsx)("span",{className:"text-gray-700",children:m?.email})})]})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Environment"}),(0,t.jsx)("div",{className:"flex space-x-2",children:f.map(e=>(0,t.jsx)("button",{onClick:()=>A(e.id),className:`px-4 py-2 rounded-md font-medium transition-colors ${v===e.id?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:e.name},e.id))})]}),(0,t.jsxs)("div",{ref:L,className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"API Keys"}),(0,t.jsx)("button",{onClick:()=>I(!j),disabled:!!O,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:j?"İptal":"+ Yeni API Key"})]}),O&&(0,t.jsxs)("div",{className:"bg-green-50 border-2 border-green-500 rounded-lg p-6 mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:"✅ API Key Oluşturuldu!"}),(0,t.jsx)("p",{className:"text-sm text-green-800 mb-4",children:"Bu key sadece bir kez gösterilecek. Lütfen güvenli bir yerde saklayın."}),(0,t.jsx)("div",{className:"bg-white border border-green-300 rounded p-4 mb-4",children:(0,t.jsx)("code",{className:"text-sm text-gray-900 break-all",children:O})}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(O),D(!0),setTimeout(()=>D(!1),2e3)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium",children:_?"✓ Kopyalandı":"Kopyala"}),(0,t.jsx)("button",{onClick:()=>{C(""),I(!1)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 font-medium",children:"Kapat"})]})]}),j&&!O&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Yeni API Key Oluştur"}),(0,t.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Adı"}),(0,t.jsx)("input",{type:"text",required:!0,value:T.name,onChange:e=>k({...T,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Production Mobile App"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Tipi"}),(0,t.jsxs)("select",{value:T.keyType,onChange:e=>k({...T,keyType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"server",children:"Server-side (tam erişim)"}),(0,t.jsx)("option",{value:"client",children:"Client-side (sadece okuma)"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"server"===T.keyType?"Backend uygulamalar için. Tüm flag bilgilerine erişir.":"Frontend uygulamalar için. Sadece aktif flag değerlerini döner."})]}),(0,t.jsx)("button",{type:"submit",disabled:E,className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium disabled:opacity-50",children:E?"Oluşturuluyor...":"Oluştur"})]})]}),0===N.length?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"Bu environment için henüz API key oluşturmadınız."}),(0,t.jsx)("button",{onClick:()=>I(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"İlk API key'inizi oluşturun →"})]}):(0,t.jsx)("div",{ref:P,className:"bg-white rounded-lg shadow overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ad"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prefix"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tip"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Son Kullanım"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(e=>(0,t.jsxs)("tr",{className:"api-key-card hover:bg-gray-50",onMouseEnter:e=>(0,d.cardHover)(e.currentTarget),onMouseLeave:e=>(0,d.cardHoverEnd)(e.currentTarget),children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("code",{className:"text-sm text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[e.keyPrefix,"..."]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded ${"server"===e.keyType?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:e.keyType})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.lastUsedAt?.toDate?.()?.toLocaleDateString("tr-TR")||"Hiç kullanılmadı"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,t.jsx)("button",{onClick:()=>U(e.id),className:"text-red-600 hover:text-red-900 font-medium",children:"İptal Et"})})]},e.id))})]})})]})})]}):null}e.s(["default",()=>c])},39007,e=>{e.v(t=>Promise.all(["static/chunks/6b0a6e6e30d1308a.js"].map(t=>e.l(t))).then(()=>t(85123)))},49847,e=>{e.v(t=>Promise.all(["static/chunks/0f624e89cf31ab38.js"].map(t=>e.l(t))).then(()=>t(28750)))},77861,e=>{e.v(t=>Promise.all(["static/chunks/434ecb641055f33d.js"].map(t=>e.l(t))).then(()=>t(11615)))}]);