(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18545,(e,t,s)=>{t.exports=e.r(7284)},8643,e=>{"use strict";let t=null,s=()=>(t||(t=e.A(77861).then(e=>e.default)),t);e.s(["buttonRipple",0,e=>{let t=e.currentTarget,a=t.getBoundingClientRect(),r=e.clientX-a.left,l=e.clientY-a.top,n=document.createElement("span");n.style.cssText=`
    position: absolute;
    left: ${r}px;
    top: ${l}px;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.6);
    transform: translate(-50%, -50%);
    pointer-events: none;
  `,t.style.position="relative",t.style.overflow="hidden",t.appendChild(n),s()?.then(e=>{e({targets:n,width:2*Math.max(a.width,a.height),height:2*Math.max(a.width,a.height),opacity:[.6,0],duration:600,easing:"easeOutQuad",complete:()=>n.remove()})})},"cardHover",0,e=>{s()?.then(t=>{t({targets:e,scale:1.05,translateY:-8,duration:300,easing:"easeOutCubic"})})},"cardHoverEnd",0,e=>{s()?.then(t=>{t({targets:e,scale:1,translateY:0,duration:300,easing:"easeOutCubic"})})},"fadeIn",0,(e,t=0)=>{s()?.then(s=>{s({targets:e,opacity:[0,1],translateY:[20,0],duration:800,delay:t,easing:"easeOutCubic"})})},"scaleIn",0,(e,t=0)=>{s()?.then(s=>{s({targets:e,opacity:[0,1],scale:[.8,1],duration:600,delay:t,easing:"easeOutElastic(1, .6)"})})},"slideInBottom",0,(e,t=0)=>{s()?.then(s=>{s({targets:e,opacity:[0,1],translateY:[100,0],duration:1e3,delay:t,easing:"easeOutExpo"})})},"staggerFadeIn",0,e=>{s()?.then(t=>{t({targets:e,opacity:[0,1],translateY:[30,0],duration:800,delay:t.stagger(100),easing:"easeOutCubic"})})}])},16197,e=>{"use strict";var t=e.i(85434),s=e.i(78027),a=e.i(18545),r=e.i(16015);e.i(4937);var l=e.i(78361),n=e.i(8643);function i(){let e=(0,a.useParams)().projectKey,[i,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),g=(0,s.useRef)(null),b=(0,s.useRef)(null);async function f(){try{u(!0);let t=(0,l.query)((0,l.collection)(r.db,"projects"),(0,l.where)("key","==",e)),s=await (0,l.getDocs)(t);if(s.empty)return;let a=s.docs[0].id,n=(0,l.query)((0,l.collection)(r.db,"webhooks"),(0,l.where)("projectId","==",a)),i=(await (0,l.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}));c(i)}catch(e){console.error("Error loading webhooks:",e)}finally{u(!1)}}async function y(e,t){try{await (0,l.updateDoc)((0,l.doc)(r.db,"webhooks",e),{enabled:t,updatedAt:(0,l.serverTimestamp)()}),c(s=>s.map(s=>s.id===e?{...s,enabled:t}:s))}catch(e){console.error("Error toggling webhook:",e)}}async function j(e){if(confirm("Are you sure you want to delete this webhook?"))try{await (0,l.deleteDoc)((0,l.doc)(r.db,"webhooks",e)),c(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error deleting webhook:",e)}}async function w(e){p(e.id);try{let t=await fetch("/api/webhooks/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({webhookId:e.id})}),s=await t.json();s.success?alert("✅ Webhook test successful!"):alert(`❌ Webhook test failed: ${s.error}`)}catch(e){alert(`❌ Error: ${e.message}`)}finally{p(null)}}return((0,s.useEffect)(()=>{document.title="Webhooks | Flagship"},[]),(0,s.useEffect)(()=>{f()},[e]),(0,s.useEffect)(()=>{g.current&&(0,n.fadeIn)(g.current,0),b.current&&(0,n.slideInBottom)(b.current,200)},[d]),(0,s.useEffect)(()=>{document.querySelectorAll(".webhook-card").length>0&&(0,n.staggerFadeIn)(".webhook-card")},[i]),d)?(0,t.jsx)("div",{className:"p-8",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{ref:g,className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Webhooks"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Get notified when flags change"})]}),(0,t.jsx)("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+ Create Webhook"})]}),0===i.length?(0,t.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No webhooks"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new webhook."}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Webhook"})})]}):(0,t.jsx)("div",{ref:b,className:"bg-white rounded-lg border overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Provider"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Events"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(e=>(0,t.jsxs)("tr",{className:"webhook-card",onMouseEnter:e=>(0,n.cardHover)(e.currentTarget),onMouseLeave:e=>(0,n.cardHoverEnd)(e.currentTarget),children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.url})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 capitalize",children:e.provider})}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.events.map(e=>(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:e},e))})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:t=>y(e.id,t.target.checked),className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[(0,t.jsx)("button",{onClick:()=>w(e),disabled:m===e.id,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50",children:m===e.id?"Testing...":"Test"}),(0,t.jsx)("button",{onClick:()=>j(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id))})]})}),h&&(0,t.jsx)(o,{projectKey:e,onClose:()=>x(!1),onSuccess:()=>{f(),x(!1)}})]})})}function o({projectKey:e,onClose:a,onSuccess:n}){let[i,o]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)("custom"),[x,m]=(0,s.useState)([]),[p,g]=(0,s.useState)(""),[b,f]=(0,s.useState)(!1);async function y(){if(!i||!c||0===x.length)return void alert("Please fill in all required fields");f(!0);try{let t=(0,l.query)((0,l.collection)(r.db,"projects"),(0,l.where)("key","==",e)),s=await (0,l.getDocs)(t);if(s.empty)throw Error("Project not found");let a=s.docs[0].id;await (0,l.addDoc)((0,l.collection)(r.db,"webhooks"),{projectId:a,name:i,url:c,provider:u,events:x,enabled:!0,secret:p||null,createdAt:(0,l.serverTimestamp)(),updatedAt:(0,l.serverTimestamp)()}),n()}catch(e){console.error("Error creating webhook:",e),alert("Failed to create webhook")}finally{f(!1)}}return(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Create Webhook"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,t.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Production Slack Notifications"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider *"}),(0,t.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"custom",children:"Custom"}),(0,t.jsx)("option",{value:"slack",children:"Slack"}),(0,t.jsx)("option",{value:"discord",children:"Discord"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Webhook URL *"}),(0,t.jsx)("input",{type:"url",value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://hooks.slack.com/services/..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Events to Listen *"}),(0,t.jsx)("div",{className:"space-y-2",children:["flag.created","flag.updated","flag.deleted","flag.toggled","targeting.updated"].map(e=>(0,t.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:x.includes(e),onChange:()=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm",children:e})]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secret (optional)"}),(0,t.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Used to sign webhook payloads"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"If provided, payloads will be signed with HMAC-SHA256"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,t.jsx)("button",{onClick:a,disabled:b,className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,t.jsx)("button",{onClick:y,disabled:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:b?"Creating...":"Create Webhook"})]})]})})}e.s(["default",()=>i])},77861,e=>{e.v(t=>Promise.all(["static/chunks/434ecb641055f33d.js"].map(t=>e.l(t))).then(()=>t(11615)))}]);