module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},73804,(a,b,c)=>{"use strict";b.exports=a.r(96086).vendored.contexts.AppRouterContext},97556,(a,b,c)=>{"use strict";b.exports=a.r(96086).vendored.contexts.HooksClientContext},98950,(a,b,c)=>{"use strict";b.exports=a.r(96086).vendored.contexts.ServerInsertedHtml},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},36470,a=>{"use strict";a.s(["buttonRipple",0,a=>{},"cardHover",0,a=>{},"cardHoverEnd",0,a=>{},"fadeIn",0,(a,b=0)=>{},"scaleIn",0,(a,b=0)=>{},"slideInBottom",0,(a,b=0)=>{},"staggerFadeIn",0,a=>{}])},32994,a=>{"use strict";var b=a.i(6559),c=a.i(33895),d=a.i(59283),e=a.i(71022);a.i(70853);var f=a.i(3837),g=a.i(36470);function h(){let a=(0,d.useParams)().projectKey,[h,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),q=(0,c.useRef)(null),r=(0,c.useRef)(null);async function s(){try{l(!0);let b=(0,f.query)((0,f.collection)(e.db,"projects"),(0,f.where)("key","==",a)),c=await (0,f.getDocs)(b);if(c.empty)return;let d=c.docs[0].id,g=(0,f.query)((0,f.collection)(e.db,"webhooks"),(0,f.where)("projectId","==",d)),h=(await (0,f.getDocs)(g)).docs.map(a=>({id:a.id,...a.data()}));j(h)}catch(a){console.error("Error loading webhooks:",a)}finally{l(!1)}}async function t(a,b){try{await (0,f.updateDoc)((0,f.doc)(e.db,"webhooks",a),{enabled:b,updatedAt:(0,f.serverTimestamp)()}),j(c=>c.map(c=>c.id===a?{...c,enabled:b}:c))}catch(a){console.error("Error toggling webhook:",a)}}async function u(a){if(confirm("Are you sure you want to delete this webhook?"))try{await (0,f.deleteDoc)((0,f.doc)(e.db,"webhooks",a)),j(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Error deleting webhook:",a)}}async function v(a){p(a.id);try{let b=await fetch("/api/webhooks/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({webhookId:a.id})}),c=await b.json();c.success?alert("✅ Webhook test successful!"):alert(`❌ Webhook test failed: ${c.error}`)}catch(a){alert(`❌ Error: ${a.message}`)}finally{p(null)}}return((0,c.useEffect)(()=>{document.title="Webhooks | Flagship"},[]),(0,c.useEffect)(()=>{s()},[a]),(0,c.useEffect)(()=>{q.current&&(0,g.fadeIn)(q.current,0),r.current&&(0,g.slideInBottom)(r.current,200)},[k]),(0,c.useEffect)(()=>{document.querySelectorAll(".webhook-card").length>0&&(0,g.staggerFadeIn)(".webhook-card")},[h]),k)?(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,b.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{ref:q,className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Webhooks"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Get notified when flags change"})]}),(0,b.jsx)("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+ Create Webhook"})]}),0===h.length?(0,b.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border",children:[(0,b.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No webhooks"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new webhook."}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Webhook"})})]}):(0,b.jsx)("div",{ref:r,className:"bg-white rounded-lg border overflow-hidden",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Provider"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Events"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(a=>(0,b.jsxs)("tr",{className:"webhook-card",onMouseEnter:a=>(0,g.cardHover)(a.currentTarget),onMouseLeave:a=>(0,g.cardHoverEnd)(a.currentTarget),children:[(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a.name}),(0,b.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:a.url})]}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 capitalize",children:a.provider})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.events.map(a=>(0,b.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:a},a))})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:a.enabled,onChange:b=>t(a.id,b.target.checked),className:"sr-only peer"}),(0,b.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[(0,b.jsx)("button",{onClick:()=>v(a),disabled:o===a.id,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50",children:o===a.id?"Testing...":"Test"}),(0,b.jsx)("button",{onClick:()=>u(a.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},a.id))})]})}),m&&(0,b.jsx)(i,{projectKey:a,onClose:()=>n(!1),onSuccess:()=>{s(),n(!1)}})]})})}function i({projectKey:a,onClose:d,onSuccess:g}){let[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)("custom"),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(!1);async function t(){if(!h||!j||0===n.length)return void alert("Please fill in all required fields");s(!0);try{let b=(0,f.query)((0,f.collection)(e.db,"projects"),(0,f.where)("key","==",a)),c=await (0,f.getDocs)(b);if(c.empty)throw Error("Project not found");let d=c.docs[0].id;await (0,f.addDoc)((0,f.collection)(e.db,"webhooks"),{projectId:d,name:h,url:j,provider:l,events:n,enabled:!0,secret:p||null,createdAt:(0,f.serverTimestamp)(),updatedAt:(0,f.serverTimestamp)()}),g()}catch(a){console.error("Error creating webhook:",a),alert("Failed to create webhook")}finally{s(!1)}}return(0,b.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Create Webhook"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,b.jsx)("input",{type:"text",value:h,onChange:a=>i(a.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Production Slack Notifications"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider *"}),(0,b.jsxs)("select",{value:l,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"custom",children:"Custom"}),(0,b.jsx)("option",{value:"slack",children:"Slack"}),(0,b.jsx)("option",{value:"discord",children:"Discord"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Webhook URL *"}),(0,b.jsx)("input",{type:"url",value:j,onChange:a=>k(a.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://hooks.slack.com/services/..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Events to Listen *"}),(0,b.jsx)("div",{className:"space-y-2",children:["flag.created","flag.updated","flag.deleted","flag.toggled","targeting.updated"].map(a=>(0,b.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:n.includes(a),onChange:()=>{o(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a])},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,b.jsx)("span",{className:"text-sm",children:a})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secret (optional)"}),(0,b.jsx)("input",{type:"text",value:p,onChange:a=>q(a.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Used to sign webhook payloads"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"If provided, payloads will be signed with HMAC-SHA256"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,b.jsx)("button",{onClick:d,disabled:r,className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,b.jsx)("button",{onClick:t,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:r?"Creating...":"Create Webhook"})]})]})})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__36f786d8._.js.map